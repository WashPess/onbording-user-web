
<div class="card shadow rounded-4 mx-4">

  <div class="card-header p-4">
    <h4 class="p-0 m-0 px-2">Cadastro de Usuário</h4>
  </div>

  <div class="card-body m-0 p-4">

    <form [formGroup]="form" class="form row p-0 m-0">

      <div class="col-4 mb-3">
        <label class="form-label">Name <span class="text-danger">*</span></label>
      </div>

      <div class="col-8 mb-3 d-flex justify-content-between gap-2">
        <div class="flex-fill">
          <input
            type="text"
            name="firstname"
            placeholder="Max"
            class="form-control w-100"
            formControlName="firstName"
            [ngClass]="{ 'is-invalid': hasError(firstName?.errors) }"
          >

          <div *ngIf="firstName?.invalid && (firstName?.dirty || firstName?.touched)" class="form-text text-danger">
            <div *ngIf="firstName?.errors?.['required']">É necessario preencher o primeiro nome.</div>
            <div *ngIf="firstName?.errors?.['minlength']"> Primeiro nome deve conter no minimo 2 caracteres. </div>
            <div *ngIf="firstName?.errors?.['maxlength']"> O nome deve conter no máximo 30 caracteres.</div>
            <div *ngIf="firstName?.errors?.['onlyletters']"> O nome deve conter somente letras.</div>
          </div>

        </div>
        <div class="flex-fill">
          <input
            type="text"
            name="lastName"
            placeholder="Smith"
            class="form-control"
            formControlName="lastName"
            [ngClass]="{ 'is-invalid': hasError(lastName?.errors) }"
          >

          <div *ngIf="lastName?.invalid && (lastName?.dirty || lastName?.touched)" class="form-text text-danger">
            <div *ngIf="lastName?.errors?.['required']">É necessario preencher o ultimo nome.</div>
            <div *ngIf="lastName?.errors?.['minlength']"> O ultimo nome deve conter no minimo 2 caracteres. </div>
            <div *ngIf="lastName?.errors?.['maxlength']"> O ultimo nome deve conter no máximo 30 caracteres.</div>
            <div *ngIf="lastName?.errors?.['onlyletters']"> O último deve conter somente letras.</div>
          </div>
        </div>
      </div>

      <div class="col-4 mb-3">
        <label class="form-label">Email <span class="text-danger">*</span></label>
      </div>

      <div class="col-8 mb-3">
        <input
          class="form-control"
          type="text"
          placeholder="asdf@asdf.com"
          formControlName="email"
          name="email"
          [ngClass]="{ 'is-invalid': hasError(email?.errors) }"
        >

        <div *ngIf="email?.invalid && (email?.dirty || email?.touched)" class="form-text text-danger">
          <div *ngIf="email?.errors?.['required']">É necessario preencher o email.</div>
          <div *ngIf="email?.errors?.['email']"> O email deve ser válido. </div>
          <div *ngIf="email?.errors?.['hasdomain']"> O email deve ter um domínio válido. </div>
        </div>

      </div>

      <div class="col-4 mb-3">
        <label class="form-label">Document<span class="text-danger">*</span></label>
      </div>

      <div class="col-8 mb-3">
        <input
          type="text"
          name="document"
          class="form-control"
          placeholder="CPF / CNPJ"
          formControlName="document"
          [ngClass]="{ 'is-invalid': hasError(document?.errors) }"
          documentmask
        >

        <div *ngIf="document?.invalid && (document?.dirty || document?.touched)" class="form-text text-danger">
          <div *ngIf="document?.errors?.['required']">É necessario preencher o documento.</div>
          <div *ngIf="document?.errors?.['minlength']"> O documento deve conter no minimo 11 caracteres. </div>
          <div *ngIf="document?.errors?.['maxlength']"> O documento deve conter no máximo 14 caracteres.</div>
          <div *ngIf="document?.errors?.['onlynumber']"> O documento deve conter somente numeros.</div>
        </div>
      </div>

      <div class="col-4 mb-3">
        <label class="form-label">Nickname <span class="text-danger">*</span></label>
      </div>

      <div class="col-8 mb-3">
        <input
          type="text"
          name="nickname"
          class="form-control"
          placeholder="Nickname"
          formControlName="nickname"
          [ngClass]="{ 'is-invalid': hasError(nickname?.errors) }"
        >

        <div *ngIf="nickname?.invalid && (nickname?.dirty || nickname?.touched)" class="form-text text-danger">
          <div *ngIf="nickname?.errors?.['required']">É necessario preencher o apelido.</div>
          <div *ngIf="nickname?.errors?.['minlength']"> O apelido deve conter no minimo 2 caracteres. </div>
          <div *ngIf="nickname?.errors?.['maxlength']"> O apelido deve conter no máximo 30 caracteres.</div>
        </div>

      </div>

      <div class="col-4 mb-3">
        <label class="form-label">Password <span class="text-danger">*</span></label>
      </div>

      <div class="col-8 mb-3">
        <input
          type="text"
          name="password"
          placeholder="***"
          class="form-control"
          formControlName="password"
          [ngClass]="{ 'is-invalid': hasError(password?.errors) }"

        >

        <div *ngIf="password?.invalid && (password?.dirty || password?.touched)" class="form-text text-danger">
          <div *ngIf="password?.errors?.['required']">É necessario preencher a senha.</div>
          <div *ngIf="password?.errors?.['pattern']">A senha deve conter letras maiusculas, minusculas, números e caracteres especiais.</div>
        </div>
      </div>

      <div class="col-4 mb-3">
        <label class="form-label">Confirm Password<span class="text-danger">*</span></label>
      </div>

      <div class="col-8 mb-3">
        <input
          type="text"
          placeholder="***"
          class="form-control"
          name="confirmPassword"
          formControlName="confirmPassword"
          [ngClass]="{ 'is-invalid': hasError(confirmPassword?.errors) }"
        >
        <div *ngIf="confirmPassword?.invalid && (confirmPassword?.dirty || confirmPassword?.touched)" class="form-text text-danger">
          <div *ngIf="confirmPassword?.errors?.['required']">É necessario preencher a confirmaçao da senha nome.</div>
          <div *ngIf="confirmPassword?.errors?.['match']"> A confirmação e a senha não combinam. </div>
        </div>
      </div>

      <div class="col-4 mb-3">
        <label class="form-label">Accept terms<span class="text-danger">*</span></label>
      </div>

      <div class="col-8 mb-3">
        <div class="form-check">
          <input
            name="optin"
            type="checkbox"
            id="optin-terms"
            formControlName="optin"
            class="form-check-input"
          >
          <label class="form-check-label" for="optin-terms">
            Accept
          </label>
        </div>

        <div *ngIf="true" class="form-text text-danger">
          <div *ngIf="optin?.errors?.['istrue']">É necessario aceitar os termos.</div>
        </div>

      </div>

    </form>

  </div>

  <div class="card-footer p-4">
    <div class="d-flex justify-content-end gap-2">

      <button class="btn btn-light border text-muted" (click)="reset()">Discartar</button>

      <button class="btn btn-primary" (click)="save()" [disabled]="(loadingSave$ | async)">

        <ng-container *ngIf="!(loadingSave$ | async)">
          <span>Salvar alterações</span>
        </ng-container>

        <ng-container *ngIf="(loadingSave$ | async)">
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          <span class="visually-hidden">Carregando...</span>
          <span class="ms-2">Esperando...</span>
        </ng-container>

      </button>

    </div>
  </div>

</div>
